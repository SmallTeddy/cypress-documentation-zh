"use strict";(self.webpackChunkcypress_docusaurus_zh=self.webpackChunkcypress_docusaurus_zh||[]).push([[7936],{5805:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});var a=n(5893),i=n(1151);const t={title:"Cypress.session"},o=void 0,r={id:"api/cypress-api/session",title:"Cypress.session",description:"Cypress.session is a collection of async session-related helper methods",source:"@site/docs/api/cypress-api/session.mdx",sourceDirName:"api/cypress-api",slug:"/api/cypress-api/session",permalink:"/api/cypress-api/session",draft:!1,unlisted:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/cypress-api/session.mdx",tags:[],version:"current",lastUpdatedAt:1732009455,formattedLastUpdatedAt:"Nov 19, 2024",frontMatter:{title:"Cypress.session"},sidebar:"api",previous:{title:"Cypress.SelectorPlayground",permalink:"/api/cypress-api/selector-playground-api"},next:{title:"Cypress.spec",permalink:"/api/cypress-api/spec"}},l={},c=[{value:"Syntax",id:"Syntax",level:2},{value:"Arguments",id:"Arguments",level:3},{value:"Examples",id:"Examples",level:2},{value:"Clearing the all session data",id:"Clearing-the-all-session-data",level:3},{value:"Clearing the current session data when testIsolation is disabled",id:"Clearing-the-current-session-data-when-testIsolation-is-disabled",level:3},{value:"Verified the Applied Session Data",id:"Verified-the-Applied-Session-Data",level:3},{value:"Debugging Cached Session Data",id:"Debugging-Cached-Session-Data",level:3},{value:"See also",id:"See-also",level:2}];function d(e){const s={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.a)(),...e.components},{DocsImage:n,Icon:t}=s;return n||p("DocsImage",!0),t||p("Icon",!0),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(s.p,{children:[(0,a.jsx)(s.code,{children:"Cypress.session"})," is a collection of async session-related helper methods\nintended to be used alongside the ",(0,a.jsx)(s.a,{href:"/api/commands/session",children:(0,a.jsx)(s.code,{children:"cy.session()"})}),"\ncommand."]}),"\n",(0,a.jsx)(s.h2,{id:"Syntax",children:"Syntax"}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-javascript",children:"// Clear all sessions saved on the backend, including cached global sessions.\nCypress.session.clearAllSavedSessions()\n// Clear all storage and cookie date across all origins associated with the current session.\nCypress.session.clearCurrentSessionData()\n// Get all storage and cookie data across all origins associated with the current session.\nCypress.session.getCurrentSessionData()\n// Get all storage and cookie data saved on the backend associated with the provided session id.\nCypress.session.getSession(id)\n"})}),"\n",(0,a.jsxs)(s.p,{children:["Clearing all session and automatically re-running the spec\n",(0,a.jsx)(s.code,{children:"Cypress.session.clearAllSavedSessions()"}),' can also be done by clicking the\n"Clear All Sessions" button in the\n',(0,a.jsx)(s.a,{href:"/api/commands/session#The-Instrument-Panel",children:"Sessions Instrument Panel"}),"."]}),"\n",(0,a.jsx)(n,{src:"/img/api/session/sessions-panel.png",alt:"Sessions Instrument Panel"}),"\n",(0,a.jsx)(s.h3,{id:"Arguments",children:"Arguments"}),"\n",(0,a.jsxs)(s.p,{children:[(0,a.jsx)(t,{name:"angle-right"})," ",(0,a.jsxs)(s.strong,{children:["id ",(0,a.jsx)(s.em,{children:"(String)"})]})]}),"\n",(0,a.jsx)(s.p,{children:"The name of the session used to retrieve data storage and cookie data."}),"\n",(0,a.jsx)(s.h2,{id:"Examples",children:"Examples"}),"\n",(0,a.jsx)(s.h3,{id:"Clearing-the-all-session-data",children:"Clearing the all session data"}),"\n",(0,a.jsxs)(s.p,{children:["By default, Cypress will clear the current session data ",(0,a.jsx)(s.strong,{children:"before"})," each test\nwhen ",(0,a.jsx)(s.code,{children:"testIsolation"})," is enabled. You can also remove all cached session data\nwith ",(0,a.jsx)(s.code,{children:"Cypress.session.clearAllSavedSessions()"}),"."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-js",children:"Cypress.session.clearAllSavedSessions()\n"})}),"\n",(0,a.jsx)(s.h3,{id:"Clearing-the-current-session-data-when-testIsolation-is-disabled",children:"Clearing the current session data when testIsolation is disabled"}),"\n",(0,a.jsxs)(s.p,{children:["By default, Cypress will clear the current session data ",(0,a.jsx)(s.strong,{children:"before"})," each test\nwhen ",(0,a.jsx)(s.code,{children:"testIsolation"})," is enabled. If you have disabled ",(0,a.jsx)(s.code,{children:"testIsolation"})," for a\nsuite, it can be helpful to clear the current session data in a ",(0,a.jsx)(s.code,{children:"before()"})," block\nto ensure the suite started in a clean test slate."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-js",children:"describe('Dashboard', { testIsolation: false }, () => {\n  before(() => {\n    // ensure clean test slate for these tests\n    cy.then(Cypress.session.clearCurrentSessionData)\n  })\n})\n"})}),"\n",(0,a.jsx)(s.h3,{id:"Verified-the-Applied-Session-Data",children:"Verified the Applied Session Data"}),"\n",(0,a.jsxs)(s.p,{children:["To check all cookies, localStorage and sessionStorage that was applied after\n",(0,a.jsx)(s.code,{children:"cy.session()"})," completes, you can use ",(0,a.jsx)(s.code,{children:"Cypress.session.getCurrentSessionData()"}),".\nThis can be helpful for quickly analyzing the current browser context while\nwriting your ",(0,a.jsx)(s.code,{children:"cy.session()"})," command."]}),"\n",(0,a.jsxs)(s.p,{children:["Since this is an all-in-one helper of the ",(0,a.jsx)(s.code,{children:"cy.getAllCookies()"}),",\n",(0,a.jsx)(s.code,{children:"cy.getAllLocalStorage()"})," and ",(0,a.jsx)(s.code,{children:"cy.getAllSessionStorage()"})," commands, we generally\nrecommend leveraging these commands for asserting the correct session data has\nbeen applied in the session validation block."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-js",children:"it('debug session', () => {\n    cy.session('id', () => {\n        ...\n    })\n    .then(async () => {\n        const sessionData = await Cypress.session.getCurrentSessionData()\n        cy.debug()\n    })\n})\n"})}),"\n",(0,a.jsx)(s.h3,{id:"Debugging-Cached-Session-Data",children:"Debugging Cached Session Data"}),"\n",(0,a.jsxs)(s.p,{children:["If your session seems to be recreated more than expected, or doesn't seem to be\napplying the cookies, ",(0,a.jsx)(s.code,{children:"localStorage"})," or ",(0,a.jsx)(s.code,{children:"sessionStorage"})," data that you'd expect,\nyou can use ",(0,a.jsx)(s.code,{children:"Cypress.session.getSession(id)"})," to view what session data has been\ncached by ",(0,a.jsx)(s.code,{children:"cy.session()"}),". If you are missing any data, your setup and/or\nvalidate function may not be waiting long enough for all attributes to be\napplied to there page before the ",(0,a.jsx)(s.code,{children:"cy.session()"})," command saves and finishes."]}),"\n",(0,a.jsx)(s.pre,{children:(0,a.jsx)(s.code,{className:"language-js",children:"it('debug session', () => {\n    cy.session('id', () => {\n        ...\n    })\n    .then(async () => {\n        const sessionData = await Cypress.session.getSession('id')\n        cy.debug()\n    })\n})\n"})}),"\n",(0,a.jsx)(s.h2,{id:"See-also",children:"See also"}),"\n",(0,a.jsxs)(s.ul,{children:["\n",(0,a.jsx)(s.li,{children:(0,a.jsx)(s.a,{href:"/api/commands/session",children:(0,a.jsx)(s.code,{children:"cy.session()"})})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,a.jsx)(s,{...e,children:(0,a.jsx)(d,{...e})}):d(e)}function p(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},1151:(e,s,n)=>{n.d(s,{Z:()=>r,a:()=>o});var a=n(7294);const i={},t=a.createContext(i);function o(e){const s=a.useContext(t);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function r(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(t.Provider,{value:s},e.children)}}}]);