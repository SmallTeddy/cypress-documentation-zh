"use strict";(self.webpackChunkcypress_docusaurus_zh=self.webpackChunkcypress_docusaurus_zh||[]).push([[7267],{1677:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>c,toc:()=>d});var s=i(5893),t=i(1151);const o={title:"invoke",slug:"/api/commands/invoke"},r=void 0,c={id:"api/commands/invoke",title:"invoke",description:"Invoke a function on the previously yielded subject.",source:"@site/docs/api/commands/invoke.mdx",sourceDirName:"api/commands",slug:"/api/commands/invoke",permalink:"/api/commands/invoke",draft:!1,unlisted:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/commands/invoke.mdx",tags:[],version:"current",lastUpdatedAt:1732009455,formattedLastUpdatedAt:"Nov 19, 2024",frontMatter:{title:"invoke",slug:"/api/commands/invoke"},sidebar:"api",previous:{title:"intercept",permalink:"/api/commands/intercept"},next:{title:"its",permalink:"/api/commands/its"}},a={},d=[{value:"Syntax",id:"Syntax",level:2},{value:"Usage",id:"Usage",level:3},{value:"Arguments",id:"Arguments",level:3},{value:"Yields <Icon></Icon>",id:"Yields",level:3},{value:"Examples",id:"Examples",level:2},{value:"Function",id:"Function",level:3},{value:"Assert on a function&#39;s return value",id:"Assert-on-a-functions-return-value",level:4},{value:"Use <code>.invoke()</code> to test HTML content",id:"Use-invoke-to-test-HTML-content",level:4},{value:"Properties that are functions are invoked",id:"Properties-that-are-functions-are-invoked",level:4},{value:"Use <code>.invoke(&#39;show&#39;)</code> and <code>.invoke(&#39;trigger&#39;)</code>",id:"Use-invokeshow-and-invoketrigger",level:4},{value:"Function with Arguments",id:"Function-with-Arguments",level:3},{value:"Send specific arguments to the function",id:"Send-specific-arguments-to-the-function",level:4},{value:"Use <code>cy.invoke(&#39;removeAttr&#39;, &#39;target&#39;)</code> to get around new tab",id:"Use-cyinvokeremoveAttr-target-to-get-around-new-tab",level:4},{value:"Arguments are automatically forwarded to the function",id:"Arguments-are-automatically-forwarded-to-the-function",level:4},{value:"Arrays",id:"Arrays",level:3},{value:"jQuery method",id:"jQuery-method",level:3},{value:"Notes",id:"Notes",level:2},{value:"Third Party Plugins",id:"Third-Party-Plugins",level:3},{value:"Using a Kendo DropDown",id:"Using-a-Kendo-DropDown",level:4},{value:"Retries",id:"Retries",level:3},{value:"Rules",id:"Rules",level:2},{value:"Requirements <Icon></Icon>",id:"Requirements",level:3},{value:"Assertions <Icon></Icon>",id:"Assertions",level:3},{value:"Timeouts <Icon></Icon>",id:"Timeouts",level:3},{value:"Command Log",id:"Command-Log",level:2},{value:"History",id:"History",level:2},{value:"See also",id:"See-also",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.a)(),...e.components},{DocsImage:i,Icon:o}=n;return i||u("DocsImage",!0),o||u("Icon",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Invoke a function on the previously yielded subject."}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["If you want to get a property that is not a function on the previously yielded\nsubject, use ",(0,s.jsx)(n.a,{href:"/api/commands/its",children:(0,s.jsx)(n.code,{children:".its()"})}),"."]})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["If you chain further commands off of ",(0,s.jsx)(n.code,{children:".invoke()"}),", it will be called multiple\ntimes. If you only want the method to be called once, end your chain with\n",(0,s.jsx)(n.code,{children:".invoke()"})," and start fresh with ",(0,s.jsx)(n.code,{children:"cy"})," afterwards."]})}),"\n",(0,s.jsx)(n.h2,{id:"Syntax",children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:".invoke(functionName)\n.invoke(options, functionName)\n.invoke(functionName, args...)\n.invoke(options, functionName, args...)\n\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Usage",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(o,{name:"check-circle",color:"green"})," ",(0,s.jsx)(n.strong,{children:"Correct Usage"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.get('.input').invoke('val').should('eq', 'foo') // Invoke the 'val' function\ncy.get('.modal').invoke('show') // Invoke the jQuery 'show' function\ncy.wrap({ animate: fn }).invoke('animate') // Invoke the 'animate' function\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(o,{name:"exclamation-triangle",color:"red"})," ",(0,s.jsx)(n.strong,{children:"Incorrect Usage"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.invoke('convert') // Errors, cannot be chained off 'cy'\ncy.wrap({ name: 'Jane' }).invoke('name') // Errors, 'name' is not a function\ncy.wrap({ animate: fn })\n  .invoke('animate')\n  .then(() => {}) // 'animate' will be called multiple times\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Arguments",children:"Arguments"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(o,{name:"angle-right"})," ",(0,s.jsxs)(n.strong,{children:["functionName ",(0,s.jsx)(n.em,{children:"(String, Number)"})]})]}),"\n",(0,s.jsx)(n.p,{children:"Name of function to be invoked."}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(o,{name:"angle-right"})," ",(0,s.jsxs)(n.strong,{children:["options ",(0,s.jsx)(n.em,{children:"(Object)"})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Pass in an options object to change the default behavior of ",(0,s.jsx)(n.code,{children:".invoke()"}),"."]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsxs)(n.td,{children:["Displays the command in the ",(0,s.jsx)(n.a,{href:"/app/core-concepts/open-mode#Command-Log",children:"Command log"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"timeout"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/configuration#Timeouts",children:(0,s.jsx)(n.code,{children:"defaultCommandTimeout"})})}),(0,s.jsxs)(n.td,{children:["Time to wait for ",(0,s.jsx)(n.code,{children:".invoke()"})," to resolve before ",(0,s.jsx)(n.a,{href:"#Timeouts",children:"timing out"})]})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(o,{name:"angle-right"})," args...**"]}),"\n",(0,s.jsx)(n.p,{children:"Additional arguments to be given to the function call. There is no limit to the\nnumber of arguments."}),"\n",(0,s.jsxs)(n.h3,{id:"Yields",children:["Yields ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Subject-Management",children:(0,s.jsx)(o,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," yields the return value of the method."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," is a query, and it is ",(0,s.jsx)(n.em,{children:"safe"})," to chain further commands."]}),"\n",(0,s.jsxs)(n.li,{children:["If you chain additional commands off of ",(0,s.jsx)(n.code,{children:".invoke()"}),", the function will be\ncalled multiple times!"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"Examples",children:"Examples"}),"\n",(0,s.jsx)(n.h3,{id:"Function",children:"Function"}),"\n",(0,s.jsx)(n.h4,{id:"Assert-on-a-functions-return-value",children:"Assert on a function's return value"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const fn = () => {\n  return 'bar'\n}\n\ncy.wrap({ foo: fn }).invoke('foo').should('eq', 'bar') // true\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"Use-invoke-to-test-HTML-content",children:["Use ",(0,s.jsx)(n.code,{children:".invoke()"})," to test HTML content"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"/app/references/recipes#Server-Communication",children:["Check out our example recipe where we use ",(0,s.jsx)(n.code,{children:"cy.invoke('text')"})," to test against HTML content in 'Bootstrapping your App'"]})})}),"\n",(0,s.jsx)(n.h4,{id:"Properties-that-are-functions-are-invoked",children:"Properties that are functions are invoked"}),"\n",(0,s.jsxs)(n.p,{children:["In the example below, we use ",(0,s.jsx)(n.code,{children:".invoke()"})," to force a hidden div to be\n",(0,s.jsx)(n.code,{children:"'display: block'"})," so we can interact with its children elements."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.get('div.container')\n  .should('be.hidden') // element is hidden\n  .invoke('show') // call jquery method 'show' on the '.container'\n  .should('be.visible') // element is visible now\n  .find('input') // drill down into a child \"input\" element\n  .type('Cypress is great') // and type text\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"Use-invokeshow-and-invoketrigger",children:["Use ",(0,s.jsx)(n.code,{children:".invoke('show')"})," and ",(0,s.jsx)(n.code,{children:".invoke('trigger')"})]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"/app/references/recipes#Testing-the-DOM",children:["Check out our example recipe where we use ",(0,s.jsx)(n.code,{children:"cy.invoke('show')"})," and ",(0,s.jsx)(n.code,{children:"cy.invoke('trigger')"})," to click an element that is only visible on hover"]})})}),"\n",(0,s.jsx)(n.h3,{id:"Function-with-Arguments",children:"Function with Arguments"}),"\n",(0,s.jsx)(n.h4,{id:"Send-specific-arguments-to-the-function",children:"Send specific arguments to the function"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const fn = (a, b, c) => {\n  return a + b + c\n}\n\ncy.wrap({ sum: fn })\n  .invoke('sum', 2, 4, 6)\n  .should('be.gt', 10) // true\n  .and('be.lt', 20) // true\n"})}),"\n",(0,s.jsxs)(n.h4,{id:"Use-cyinvokeremoveAttr-target-to-get-around-new-tab",children:["Use ",(0,s.jsx)(n.code,{children:"cy.invoke('removeAttr', 'target')"})," to get around new tab"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"/app/references/recipes#Testing-the-DOM",children:["Check out our example recipe where we use ",(0,s.jsx)(n.code,{children:"cy.invoke('removeAttr', 'target')"})," to test clicking on a link without opening in a new tab"]})})}),"\n",(0,s.jsx)(n.h4,{id:"Arguments-are-automatically-forwarded-to-the-function",children:"Arguments are automatically forwarded to the function"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.get('img').invoke('attr', 'src').should('include', 'myLogo')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Arrays",children:"Arrays"}),"\n",(0,s.jsxs)(n.p,{children:["In the above examples, the subject was an object, but ",(0,s.jsx)(n.code,{children:"cy.invoke"})," also works on\narrays and allows using numerical index to pick a function to run."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const reverse = (s) => Cypress._.reverse(s)\nconst double = (n) => n * n\n\n// picks function with index 1 and calls it with argument 4\ncy.wrap([reverse, double]).invoke(1, 4).should('eq', 16)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"jQuery-method",children:"jQuery method"}),"\n",(0,s.jsxs)(n.p,{children:["If the parent command yields a jQuery element, we can invoke a jQuery method,\nlike ",(0,s.jsx)(n.code,{children:"attr"}),", ",(0,s.jsx)(n.code,{children:"text"}),", or ",(0,s.jsx)(n.code,{children:"val"}),". To confirm the element's ",(0,s.jsx)(n.code,{children:"id"})," attribute for\nexample:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-html",children:'<div id="code-snippet">The code example</div>\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"cy.contains('The code example')\n  .invoke('attr', 'id')\n  .should('equal', 'code-snippet')\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Tip:"})," Cypress has a built-in Chai-jQuery assertion to confirm the attribute.\nThe above example can be written simply as:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"cy.contains('The code example').should('have.attr', 'id', 'code-snippet')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"Notes",children:"Notes"}),"\n",(0,s.jsx)(n.h3,{id:"Third-Party-Plugins",children:"Third Party Plugins"}),"\n",(0,s.jsx)(n.h4,{id:"Using-a-Kendo-DropDown",children:"Using a Kendo DropDown"}),"\n",(0,s.jsxs)(n.p,{children:["If you are using ",(0,s.jsx)(n.code,{children:"jQuery"})," then the ",(0,s.jsx)(n.code,{children:"jQuery"})," wrapped elements will automatically\nhave your 3rd party plugins available to be called."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.get('input')\n  .invoke('getKendoDropDownList')\n  .then((dropDownList) => {\n    // yields the return of $input.getKendoDropDownList()\n    return dropDownList.select('apples')\n  })\n"})}),"\n",(0,s.jsx)(n.p,{children:"We can rewrite the previous example in a more terse way and add an assertion."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.get('input')\n  .invoke('getKendoDropDownList')\n  .invoke('select', 'apples')\n  .invoke('val')\n  .should('match', /apples/)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Retries",children:"Retries"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," automatically retries invoking the specified method until the\nreturned value satisfies the attached assertions. The example below passes after\n1 second."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"let message = 'hello'\nconst english = {\n  greeting() {\n    return message\n  },\n}\n\nsetTimeout(() => {\n  message = 'bye'\n}, 1000)\n\n// initially the english.greeting() returns \"hello\" failing the assertion.\n// .invoke('greeting') tries again and again until after 1 second\n// the returned message becomes \"bye\" and the assertion passes\ncy.wrap(english).invoke('greeting').should('equal', 'bye')\n"})}),"\n",(0,s.jsx)(i,{src:"/img/api/invoke/invoke-retries.gif",alt:"Invoke retries example","width-600":!0}),"\n",(0,s.jsx)(n.h2,{id:"Rules",children:"Rules"}),"\n",(0,s.jsxs)(n.h3,{id:"Requirements",children:["Requirements ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Chains-of-Commands",children:(0,s.jsx)(o,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," requires being chained off a previous command."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"Assertions",children:["Assertions ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Assertions",children:(0,s.jsx)(o,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," will wait for the ",(0,s.jsx)(n.code,{children:"function"})," to exist on the subject before\nrunning."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," will throw an error if the invoked ",(0,s.jsx)(n.code,{children:"function"})," returns a promise.\nIf you want to invoke a function that returns a promise, use ",(0,s.jsx)(n.a,{href:"/api/commands/then",children:(0,s.jsx)(n.code,{children:".then()"})})," instead."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," will automatically ",(0,s.jsx)(n.a,{href:"/app/core-concepts/retry-ability",children:"retry"}),"\nuntil all chained assertions have passed."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"Timeouts",children:["Timeouts ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Timeouts",children:(0,s.jsx)(o,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," can time out waiting for assertions you've added to pass."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"Command-Log",children:"Command Log"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"Invoke jQuery show method on element"})})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.get('.connectors-div')\n  .should('be.hidden')\n  .invoke('show')\n  .should('be.visible')\n"})}),"\n",(0,s.jsx)(n.p,{children:"The commands above will display in the Command Log as:"}),"\n",(0,s.jsx)(i,{src:"/img/api/invoke/invoke-jquery-show-on-element-for-testing.png",alt:"Command Log for invoke"}),"\n",(0,s.jsxs)(n.p,{children:["When clicking on ",(0,s.jsx)(n.code,{children:"invoke"})," within the command log, the console outputs the\nfollowing:"]}),"\n",(0,s.jsx)(i,{src:"/img/api/invoke/log-function-invoked-and-return.png",alt:"Console Log for invoke"}),"\n",(0,s.jsx)(n.h2,{id:"History",children:"History"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Version"}),(0,s.jsx)(n.th,{children:"Changes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#12-0-0",children:"12.0.0"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:".invoke()"})," no longer supports promises or async functions"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#3-8-0",children:"3.8.0"})}),(0,s.jsxs)(n.td,{children:["Added support for ",(0,s.jsx)(n.code,{children:"options"})," argument"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#3-7-0",children:"3.7.0"})}),(0,s.jsxs)(n.td,{children:["Added support for arguments of type Number for ",(0,s.jsx)(n.code,{children:"functionName"})]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"See-also",children:"See also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/api/commands/its",children:(0,s.jsx)(n.code,{children:".its()"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/api/commands/then",children:(0,s.jsx)(n.code,{children:".then()"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/api/commands/wrap",children:(0,s.jsx)(n.code,{children:"cy.wrap()"})})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}function u(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},1151:(e,n,i)=>{i.d(n,{Z:()=>c,a:()=>r});var s=i(7294);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);