"use strict";(self.webpackChunkcypress_docusaurus_zh=self.webpackChunkcypress_docusaurus_zh||[]).push([[1634],{8725:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var o=i(5893),t=i(1151);const s={title:"Custom Frameworks",sidebar_position:100},r=void 0,a={id:"app/component-testing/custom-frameworks",title:"Custom Frameworks",description:"What you'll learn",source:"@site/docs/app/component-testing/custom-frameworks.mdx",sourceDirName:"app/component-testing",slug:"/app/component-testing/custom-frameworks",permalink:"/app/component-testing/custom-frameworks",draft:!1,unlisted:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/app/component-testing/custom-frameworks.mdx",tags:[],version:"current",lastUpdatedAt:1732009455,formattedLastUpdatedAt:"Nov 19, 2024",sidebarPosition:100,frontMatter:{title:"Custom Frameworks",sidebar_position:100},sidebar:"app",previous:{title:"API",permalink:"/app/component-testing/svelte/api"},next:{title:"Introduction",permalink:"/app/core-concepts/introduction-to-cypress"}},l={},c=[{value:"<Icon></Icon> What you&#39;ll learn",id:"What-youll-learn",level:5},{value:"Concepts",id:"Concepts",level:2},{value:"Framework Definition",id:"Framework-Definition",level:2},{value:"Mount Adapter",id:"Mount-Adapter",level:2},{value:"package.json",id:"packagejson",level:2},{value:"Testing",id:"Testing",level:2},{value:"Publishing on npm",id:"Publishing-on-npm",level:2},{value:"Available Framework Definitions",id:"Available-Framework-Definitions",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h5:"h5",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.a)(),...e.components},{DocsImage:i,Icon:s}=n;return i||h("DocsImage",!0),s||h("Icon",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.admonition,{type:"info",children:[(0,o.jsxs)(n.h5,{id:"What-youll-learn",children:[(0,o.jsx)(s,{name:"question-circle",color:"#4BBFD2"})," What you'll learn"]}),(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"How to customize Cypress to support your favorite framework"}),"\n",(0,o.jsx)(n.li,{children:"How to create a custom Framework Definition and Mount Adapter for your framework"}),"\n",(0,o.jsx)(n.li,{children:"How to test and publish your custom framework"}),"\n"]})]}),"\n",(0,o.jsxs)(n.p,{children:["Cypress Component Testing includes\n",(0,o.jsx)(n.a,{href:"/app/component-testing/get-started#Supported-Frameworks",children:"official support"})," for\nmany popular libraries and frameworks such as\n",(0,o.jsx)(n.a,{href:"/app/component-testing/react/overview",children:"React"}),",\n",(0,o.jsx)(n.a,{href:"/app/component-testing/angular/overview",children:"Angular"}),", and\n",(0,o.jsx)(n.a,{href:"/app/component-testing/vue/overview",children:"Vue"}),". All officially supported\nlibraries feature a first class onboarding experience, where we detect and\nscaffold the correct files, and a framework-specific ",(0,o.jsx)(n.code,{children:"mount"})," adapter to render\nyour components. We call this collection of features a ",(0,o.jsx)(n.em,{children:"Framework Definition"}),"\nsince it defines the requirements for a library or framework to work in Cypress."]}),"\n",(0,o.jsx)(n.p,{children:"If your favorite library isn't featured, don't worry - we expose the same API we\nuse internally for the Cypress community to define their own Framework\nDefinitions."}),"\n",(0,o.jsx)(n.p,{children:"In this guide, you'll learn how to author a Framework Definition, which will\nenjoy the same polished onboarding experience as our officially supported\nframeworks."}),"\n",(0,o.jsx)(n.h2,{id:"Concepts",children:"Concepts"}),"\n",(0,o.jsx)(n.p,{children:"There are a few requirements for authoring a Framework Definition."}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"#Framework-Definition",children:"Definition File"})," (we recommending naming this\n",(0,o.jsx)(n.code,{children:"definition.cjs"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"#Mount-Adapter",children:"Mount Adapter"})," (we recommending naming this ",(0,o.jsx)(n.code,{children:"index.mjs"}),")"]}),"\n",(0,o.jsxs)(n.li,{children:["A ",(0,o.jsx)(n.a,{href:"#packagejson",children:(0,o.jsx)(n.code,{children:"package.json"})})," with the correct conventions"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"The Definition is required when users configure Component Testing for the first\ntime. The Mount adapter is used to render components when writing tests."}),"\n",(0,o.jsxs)(n.p,{children:["To simplify this process, we recommend starting development using\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress-ct-definition-template",children:"our official template"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"Framework-Definition",children:"Framework Definition"}),"\n",(0,o.jsxs)(n.p,{children:["Below is a minimal Framework Definition. Note that ",(0,o.jsx)(n.code,{children:"defineFrameworkDefinition"}),"\nis purely for type safety, similar to ",(0,o.jsx)(n.code,{children:"defineConfig"})," in ",(0,o.jsx)(n.code,{children:"cypress.config"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["There is one important convention; the ",(0,o.jsx)(n.code,{children:"type"})," key in ",(0,o.jsx)(n.code,{children:"defineFrameworkDefinition"}),"\nshould match the name of your package on npm, and should be named using one of\nthe following conventions:"]}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"cypress-ct-*"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"@organization/cypress-ct-*"})}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"Some examples of valid names include:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"cypress-ct-react-js"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"cypress-ct-svelte-testing"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"@cypress/cypress-ct-react"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"@angular/cypress-ct-angular"})}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["When configuring a project to use Component Testing, Cypress will load any\ndependencies following this naming convention from the project's ",(0,o.jsx)(n.code,{children:"node_modules"}),"\nand present them as framework options."]}),"\n",(0,o.jsxs)(n.p,{children:["A simple example of a Framework Definition for the\n",(0,o.jsx)(n.a,{href:"https://www.solidjs.com/",children:"Solid.js"})," library is shown below. We generally\nrecommend naming this ",(0,o.jsx)(n.code,{children:"definition.cjs"}),". In our\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress-ct-definition-template",children:"official template"}),",\nthis file is at the root level of the package."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:'const { defineFrameworkDefinition } = require(\'cypress\')\n\nconst solidDep = {\n  // Unique, semantic identifier.\n  type: \'solid-js\',\n\n  // Human readable name.\n  name: \'Solid\',\n\n  // Package name install from `npm`.\n  package: \'solid-js\',\n\n  /**\n   * Similar to package, but can include a version or tag.\n   * Used during setup to generate an install command for users.\n   * Eg: `solid-js@next`\n   */\n  installer: \'solid-js\',\n\n  // Human readable description.\n  description:\n    \'A declarative, efficient, and flexible JavaScript library for building user interfaces.\',\n\n  // Minimum supported version.\n  minVersion: \'^1.6.0\',\n}\n\n/**\n * Similar to above. Create an smooth, seamless setup experience\n * by ensuring the user has all the necessary dependencies.\n * @type {Cypress.CypressComponentDependency}\n */\nconst solidVitePlugin = {\n  type: \'solid-js-vite-plugin\',\n  name: \'Vite Plugin Solid\',\n  package: \'vite-plugin-solid\',\n  installer: \'vite-plugin-solid\',\n  description: \'A simple integration to run solid-js with vite\',\n  minVersion: \'^1.6.0 || ^2.0.0\',\n}\n\n/**\n * The actual definition.\n */\nmodule.exports = defineFrameworkDefinition({\n  /**\n   * This should match the `npm` package name.\n   * The convention required to ensure your Definition is processed\n   * by Cypress is `cypress-ct-*` for global packages, or\n   * `@org/cypress-ct-*` for organization level packages.\n   */\n  type: \'@lmiller1990/cypress-ct-solid-js\',\n\n  /**\n   * The label that shows up when configuring Component Testing\n   * for the first time.\n   */\n  name: \'Solid.js\',\n\n  /**\n   * Supported bundlers. Can be "webpack" and/or "vite".\n   * In this example we only support Solid.js with Vite.\n   */\n  supportedBundlers: [\'vite\'],\n\n  /**\n   * Used by Cypress to automatically detect the correct Framework Definition\n   * based on the user\'s project.\n   * In this example, if a module matching `solidDep`\n   * is found in the user\'s project,\n   * Solid.js will automatically be selected when configuring Component Testing.\n   */\n  detectors: [solidDep],\n\n  /**\n   * Supply a set of dependencies a project should have to use this Framework Definition. The user will be prompted to install them if they are not found.\n   * Optionally, supply different dependencies based on the chosen bundler.\n   */\n  dependencies: (bundler) => {\n    return [solidDep, solidVitePlugin]\n  },\n\n  /**\n   * An SVG icon. Shown when configuring Component Testing for the first time.\n   * Optional, but good for branding your Framework Definition.\n   */\n  icon: `\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 166 155.3"><path d="M163 35S110-4 69 5l-3 1c-6 2-11 5-14 9l-2 3-15 26 26 5c11 7 25 10 38 7l46 9 18-30z" fill="#76b3e1"/><linearGradient id="a" gradientUnits="userSpaceOnUse" x1="27.5" y1="3" x2="152" y2="63.5"><stop offset=".1" stop-color="#76b3e1"/><stop offset=".3" stop-color="#dcf2fd"/><stop offset="1" stop-color="#76b3e1"/></linearGradient><path d="M163 35S110-4 69 5l-3 1c-6 2-11 5-14 9l-2 3-15 26 26 5c11 7 25 10 38 7l46 9 18-30z" opacity=".3" fill="url(#a)"/><path d="M52 35l-4 1c-17 5-22 21-13 35 10 13 31 20 48 15l62-21S92 26 52 35z" fill="#518ac8"/><linearGradient id="b" gradientUnits="userSpaceOnUse" x1="95.8" y1="32.6" x2="74" y2="105.2"><stop offset="0" stop-color="#76b3e1"/><stop offset=".5" stop-color="#4377bb"/><stop offset="1" stop-color="#1f3b77"/></linearGradient><path d="M52 35l-4 1c-17 5-22 21npm install https://cdn.cypress.io/beta/npm/12.6.0/darwin-arm64/feature/ct-public-api-ab820f062d313fbef51665bdd1d883c69d89b3be/cypress.tgz-13 35 10 13 31 20 48 15l62-21S92 26 52 35z" opacity=".3" fill="url(#b)"/><linearGradient id="c" gradientUnits="userSpaceOnUse" x1="18.4" y1="64.2" x2="144.3" y2="149.8"><stop offset="0" stop-color="#315aa9"/><stop offset=".5" stop-color="#518ac8"/><stop offset="1" stop-color="#315aa9"/></linearGradient><path d="M134 80a45 45 0 00-48-15L24 85 4 120l112 19 20-36c4-7 3-15-2-23z" fill="url(#c)"/><linearGradient id="d" gradientUnits="userSpaceOnUse" x1="75.2" y1="74.5" x2="24.4" y2="260.8"><stop offset="0" stop-color="#4377bb"/><stop offset=".5" stop-color="#1a336b"/><stop offset="1" stop-color="#1a336b"/></linearGradient><path d="M114 115a45 45 0 00-48-15L4 120s53 40 94 30l3-1c17-5 23-21 13-34z" fill="url(#d)"/></svg>\n  `,\n})\n'})}),"\n",(0,o.jsx)(n.p,{children:'Our Framework Definition shows up in Cypress! It has the "community" label,\nindicating it\'s a third party definition.'}),"\n",(0,o.jsx)(i,{src:"/img/app/component-testing/framework-definition-1.png",alt:"custom framework definition"}),"\n",(0,o.jsxs)(n.p,{children:["We defined the ",(0,o.jsx)(n.code,{children:"dependencies"}),", which are also correctly handled - we haven't\ninstalled them all, so Cypress is prompting us to do so:"]}),"\n",(0,o.jsx)(i,{src:"/img/app/component-testing/framework-definition-2.png",alt:"required dependencies"}),"\n",(0,o.jsx)(n.h2,{id:"Mount-Adapter",children:"Mount Adapter"}),"\n",(0,o.jsxs)(n.p,{children:["The second part of defining a Framework Definition is the Mount Adapter. This is\nthe function that renders the component in your tests using ",(0,o.jsx)(n.code,{children:"cy.mount()"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["By default, Cypress will look for this as a ",(0,o.jsx)(n.code,{children:"mount"})," function that is a ",(0,o.jsx)(n.strong,{children:"named\nexport"})," from the package. This should be written in a ",(0,o.jsx)(n.code,{children:"index.mjs"})," file. This\nexample is for a ",(0,o.jsx)(n.a,{href:"https://www.solidjs.com/",children:"Solid.js"})," mount adapter:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"import { getContainerEl, setupHooks } from '@cypress/mount-utils'\nimport { render } from 'solid-js/web'\n\nlet dispose\n\nfunction cleanup() {\n  dispose?.()\n}\n\n/**\n * @param {() => JSX.Element} - component to render\n */\nexport function mount(component, options = {}) {\n  // Retrieve root DOM element that Cypress has prepared for this test\n  const root = getContainerEl()\n\n  dispose = render(() => component, root)\n\n  // Wait until next microtick to ensure any async render logic has executed\n  return cy.wait(0, { log: false }).then(() => {\n    if (options.log !== false) {\n      Cypress.log({\n        name: 'mount',\n        message: 'Mounted component',\n      })\n    }\n  })\n}\n\n// Cleanup between each test\nsetupHooks(cleanup)\n"})}),"\n",(0,o.jsxs)(n.p,{children:["This is different for each library, but the concept is the same - identify how\nto mount or render a component in your library, and implement it in a function\nnamed ",(0,o.jsx)(n.code,{children:"mount"})," in ",(0,o.jsx)(n.code,{children:"index.mjs"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["When a user configures Component Testing with your Framework Definition we\nautomatically configure a ",(0,o.jsx)(n.code,{children:"cy.mount"})," command using your ",(0,o.jsx)(n.code,{children:"mount"})," function in the\nComponent Testing ",(0,o.jsx)(n.code,{children:"supportFile"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-js",children:"import { mount } from '@lmiller1990/cypress-ct-solid-js'\n\nCypress.Commands.add('mount', mount)\n"})}),"\n",(0,o.jsx)(n.h2,{id:"packagejson",children:"package.json"}),"\n",(0,o.jsxs)(n.p,{children:["The final thing you need is a correctly configured ",(0,o.jsx)(n.code,{children:"package.json"}),". This example\nwas created using\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress-ct-definition-template",children:"our official template"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"There are two fields of note:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"name"}),": Your package name which must follow the\n",(0,o.jsx)(n.code,{children:"cypress-ct-*"}),"/",(0,o.jsx)(n.code,{children:"@org/cypress-ct-*"})," convention"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"exports"}),": Object referencing the two files we created to comprise the\nFramework Definition. The ",(0,o.jsx)(n.code,{children:"node"})," entry points to the Definition file, and the\n",(0,o.jsx)(n.code,{children:"default"})," entry points to the Mount Adapter:"]}),"\n"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",metastring:"{2,5-8}",children:'{\n  "name": "@lmiller1990/cypress-ct-solid-js",\n  "version": "0.0.4",\n  "description": "Example Framework Definition for Cypress and Solid.js",\n  "exports": {\n    "node": "./definition.cjs",\n    "default": "./index.mjs"\n  },\n  "files": [\n    "package.json",\n    "definition.cjs",\n    "index.mjs"\n  ],\n  "dependencies": {\n    "@cypress/mount-utils": "^4.0.0"\n  },\n  "devDependencies": {\n    "solid-js": "^1.6.0"\n  },\n  "peerDependencies": {\n    "solid-js": "^1.6.0"\n    "cypress": "^12.7.0"\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"Testing",children:"Testing"}),"\n",(0,o.jsxs)(n.p,{children:["If you develop the Framework Definition file using TypeScript, for example by\nusing\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress-ct-definition-template",children:"our official template"}),",\nas long as you don't have any compile time errors, everything should work as\nexpected. If you do run into unexpected behavior, please\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress/issues",children:"file an issue"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Mount Adapters can be more complex to test. In general, we recommend testing\nthem in the same way users consume them - using Cypress Component Testing. A\nminimal test suite for a simple Solid.js Mount Adapter can be found\n",(0,o.jsx)(n.a,{href:"https://github.com/lmiller1990/cypress-ct-solid-js/tree/main/example-project",children:"here"}),".\nAlternatively, take a look at our official\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress/tree/develop/npm/react",children:"React"})," and\n",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress/tree/develop/npm/angular",children:"Angular"})," Mount\nAdapters, both of which have extensive test suites."]}),"\n",(0,o.jsx)(n.h2,{id:"Publishing-on-npm",children:"Publishing on npm"}),"\n",(0,o.jsx)(n.p,{children:"That's it! Publish your Framework Definition on npm and start using it."}),"\n",(0,o.jsx)(n.h2,{id:"Available-Framework-Definitions",children:"Available Framework Definitions"}),"\n",(0,o.jsxs)(n.p,{children:["You can find a list of available Framework Definitions ",(0,o.jsx)(n.a,{href:"/app/component-testing/get-started#Supported-Frameworks",children:"here"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If you have created a Framework Definition we would be delighted to mention it in our documentation\nso other Cypress users on the same framework can find it. ",(0,o.jsx)(n.a,{href:"https://github.com/cypress-io/cypress-documentation/blob/main/CONTRIBUTING.md",children:"Please submit a Pull Request"}),"!"]})]})}function p(e={}){const{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}function h(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},1151:(e,n,i)=>{i.d(n,{Z:()=>a,a:()=>r});var o=i(7294);const t={},s=o.createContext(t);function r(e){const n=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),o.createElement(s.Provider,{value:n},e.children)}}}]);