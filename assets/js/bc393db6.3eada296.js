"use strict";(self.webpackChunkcypress_docusaurus_zh=self.webpackChunkcypress_docusaurus_zh||[]).push([[4114],{6384:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});var s=i(5893),l=i(1151);const t={title:"readFile",slug:"/api/commands/readfile"},a=void 0,r={id:"api/commands/readfile",title:"readFile",description:"Read a file and yield its contents.",source:"@site/docs/api/commands/readfile.mdx",sourceDirName:"api/commands",slug:"/api/commands/readfile",permalink:"/api/commands/readfile",draft:!1,unlisted:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/commands/readfile.mdx",tags:[],version:"current",lastUpdatedAt:1732009455,formattedLastUpdatedAt:"Nov 19, 2024",frontMatter:{title:"readFile",slug:"/api/commands/readfile"},sidebar:"api",previous:{title:"prevUntil",permalink:"/api/commands/prevuntil"},next:{title:"reload",permalink:"/api/commands/reload"}},d={},c=[{value:"Syntax",id:"Syntax",level:2},{value:"Usage",id:"Usage",level:3},{value:"Arguments",id:"Arguments",level:3},{value:"Yields <Icon></Icon>",id:"Yields",level:3},{value:"Examples",id:"Examples",level:2},{value:"Text",id:"Text",level:3},{value:"Read a <code>.txt</code> file",id:"Read-a-txt-file",level:4},{value:"JSON",id:"JSON",level:3},{value:"YAML",id:"YAML",level:3},{value:"Get translation data from a YAML file",id:"Get-translation-data-from-a-YAML-file",level:4},{value:"Encoding",id:"Encoding",level:3},{value:"Specify the encoding with the second argument",id:"Specify-the-encoding-with-the-second-argument",level:4},{value:"Read",id:"Read",level:4},{value:"Playing MP3 file",id:"Playing-MP3-file",level:3},{value:"Notes",id:"Notes",level:2},{value:"Existence",id:"Existence",level:3},{value:"Default file existence assertion",id:"Default-file-existence-assertion",level:4},{value:"Asserting file non-existence",id:"Asserting-file-non-existence",level:4},{value:"Read a file that might not exist",id:"Read-a-file-that-might-not-exist",level:4},{value:"Retries",id:"Retries",level:3},{value:"Automatic retries",id:"Automatic-retries",level:4},{value:"Rules",id:"Rules",level:2},{value:"Requirements <Icon></Icon>",id:"Requirements",level:3},{value:"Assertions <Icon></Icon>",id:"Assertions",level:3},{value:"Timeouts <Icon></Icon>",id:"Timeouts",level:3},{value:"Command Log",id:"Command-Log",level:2},{value:"History",id:"History",level:2},{value:"See also",id:"See-also",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.a)(),...e.components},{DocsImage:i,Icon:t}=n;return i||x("DocsImage",!0),t||x("Icon",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"Read a file and yield its contents."}),"\n",(0,s.jsx)(n.h2,{id:"Syntax",children:"Syntax"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile(filePath)\ncy.readFile(filePath, encoding)\ncy.readFile(filePath, options)\ncy.readFile(filePath, encoding, options)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Usage",children:"Usage"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(t,{name:"check-circle",color:"green"})," ",(0,s.jsx)(n.strong,{children:"Correct Usage"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile('menu.json')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Arguments",children:"Arguments"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(t,{name:"angle-right"})," ",(0,s.jsxs)(n.strong,{children:["filePath ",(0,s.jsx)(n.em,{children:"(String)"})]})]}),"\n",(0,s.jsxs)(n.p,{children:["A path to a file within the project root (the directory that contains the\n",(0,s.jsx)(n.a,{href:"/app/references/configuration",children:"Cypress configuration file"}),")."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(t,{name:"angle-right"})," ",(0,s.jsxs)(n.strong,{children:["encoding ",(0,s.jsx)(n.em,{children:"(String)"})]})]}),"\n",(0,s.jsx)(n.p,{children:"The encoding to be used when reading the file. The following encodings are\nsupported:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'ascii'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'base64'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'binary'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'hex'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'latin1'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'utf8'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'utf-8'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'ucs2'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'ucs-2'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'utf16le'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"'utf-16le'"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"null"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Using ",(0,s.jsx)(n.code,{children:"null"})," explicitly will return the file as a\n",(0,s.jsx)(n.a,{href:"/api/utilities/buffer",children:(0,s.jsx)(n.code,{children:"Cypress.Buffer"})})," instance, regardless of file\nextension."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(t,{name:"angle-right"})," ",(0,s.jsxs)(n.strong,{children:["options ",(0,s.jsx)(n.em,{children:"(Object)"})]})]}),"\n",(0,s.jsxs)(n.p,{children:["Pass in an options object to change the default behavior of ",(0,s.jsx)(n.code,{children:"cy.readFile()"}),"."]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Option"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"log"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"true"})}),(0,s.jsxs)(n.td,{children:["Displays the command in the ",(0,s.jsx)(n.a,{href:"/app/core-concepts/open-mode#Command-Log",children:"Command log"})]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"timeout"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/configuration#Timeouts",children:(0,s.jsx)(n.code,{children:"defaultCommandTimeout"})})}),(0,s.jsxs)(n.td,{children:["Time to wait for ",(0,s.jsx)(n.code,{children:"cy.readFile()"})," to resolve before ",(0,s.jsx)(n.a,{href:"#Timeouts",children:"timing out"})]})]})]})]}),"\n",(0,s.jsxs)(n.h3,{id:"Yields",children:["Yields ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Subject-Management",children:(0,s.jsx)(t,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," yields the contents of the file."]}),"\n",(0,s.jsx)(n.li,{children:"The file will be read from disk again if any upcoming command (such as an\nassertion) in the chain fails."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"Examples",children:"Examples"}),"\n",(0,s.jsx)(n.h3,{id:"Text",children:"Text"}),"\n",(0,s.jsxs)(n.h4,{id:"Read-a-txt-file",children:["Read a ",(0,s.jsx)(n.code,{children:".txt"})," file"]}),"\n",(0,s.jsx)(n.p,{children:"For any file other than JSON, the contents of the file are returned."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"// path/to/message.txt\n\nHello World\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile('path/to/message.txt').should('eq', 'Hello World') // true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"JSON",children:"JSON"}),"\n",(0,s.jsx)(n.p,{children:"For JSON, the contents yielded are parsed into JavaScript and returned."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:'// data.json\n\n{\n  "name": "Eliza",\n  "email": "eliza@example.com"\n}\n'})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile('path/to/data.json').its('name').should('eq', 'Eliza') // true\n"})}),"\n",(0,s.jsx)(n.h3,{id:"YAML",children:"YAML"}),"\n",(0,s.jsx)(n.h4,{id:"Get-translation-data-from-a-YAML-file",children:"Get translation data from a YAML file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"const YAML = require('yamljs')\n\ncy.readFile('languages/en.yml').then((str) => {\n  // parse the string into object literal\n  const english = YAML.parse(str)\n\n  cy.get('#sidebar')\n    .find('.sidebar-title')\n    .each(($el, i) => {\n      englishTitle = english.sidebar[i]\n\n      expect($el.text()).to.eq(englishTitle)\n    })\n})\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Encoding",children:"Encoding"}),"\n",(0,s.jsx)(n.h4,{id:"Specify-the-encoding-with-the-second-argument",children:"Specify the encoding with the second argument"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile('path/to/logo.png', 'base64').then((logo) => {\n  // logo will be encoded as base64\n  // and should look something like this:\n  // aIJKnwxydrB10NVWqhlmmC+ZiWs7otHotSAAAOw==...\n})\n"})}),"\n",(0,s.jsx)(n.h4,{id:"Read",children:"Read"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.fixture('path/to/logo.png', null).then((logo) => {\n  // logo will be read as a buffer\n  // and should look something like this:\n  // Buffer([0, 0, ...])\n})\n"})}),"\n",(0,s.jsx)(n.h3,{id:"Playing-MP3-file",children:"Playing MP3 file"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile('audio/sound.mp3', 'base64').then((mp3) => {\n  const uri = 'data:audio/mp3;base64,' + mp3\n  const audio = new Audio(uri)\n\n  audio.play()\n})\n"})}),"\n",(0,s.jsx)(n.h2,{id:"Notes",children:"Notes"}),"\n",(0,s.jsx)(n.h3,{id:"Existence",children:"Existence"}),"\n",(0,s.jsx)(n.h4,{id:"Default-file-existence-assertion",children:"Default file existence assertion"}),"\n",(0,s.jsxs)(n.p,{children:["By default, ",(0,s.jsx)(n.code,{children:"cy.readFile()"})," asserts that the file exists and will fail if it\ndoes not exist. It will retry reading the file if it does not initially exist\nuntil the file exists or the command times out."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// will fail after the defaultCommandTimeout is reached\ncy.readFile('does-not-exist.yaml')\n"})}),"\n",(0,s.jsx)(n.h4,{id:"Asserting-file-non-existence",children:"Asserting file non-existence"}),"\n",(0,s.jsx)(n.p,{children:"You can assert that a file does not exist like so:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// will pass if the file does not exist\ncy.readFile('does-not-exist.yaml').should('not.exist')\n"})}),"\n",(0,s.jsx)(n.h4,{id:"Read-a-file-that-might-not-exist",children:"Read a file that might not exist"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.a,{href:"/api/commands/task#Read-a-file-that-might-not-exist",children:["See our example on using ",(0,s.jsx)(n.code,{children:"cy.task()"})," to read a file that ",(0,s.jsx)(n.em,{children:"may"})," not exist."]})}),"\n",(0,s.jsx)(n.h3,{id:"Retries",children:"Retries"}),"\n",(0,s.jsx)(n.h4,{id:"Automatic-retries",children:"Automatic retries"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," will continue to read the file until it passes all of its\nassertions."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// if this assertion fails cy.readFile will poll the file\n// until it eventually passes its assertions (or times out)\ncy.readFile('some/nested/path/story.txt').should('eq', 'Once upon a time...')\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Starting in Cypress ",(0,s.jsx)(n.code,{children:"v13"}),", ",(0,s.jsx)(n.code,{children:"cy.readFile()"})," is a query, and will continue to read\nthe file until all chained commands of any type pass, not just assertions."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"// will retry until the json file has a `users[123].name` field, and\n// the assertion passes\ncy.readFile('users.json').its('users.123.name').should('eq', 'John Doe')\n"})}),"\n",(0,s.jsx)(n.h2,{id:"Rules",children:"Rules"}),"\n",(0,s.jsxs)(n.h3,{id:"Requirements",children:["Requirements ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Chains-of-Commands",children:(0,s.jsx)(t,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," requires being chained off of ",(0,s.jsx)(n.code,{children:"cy"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," requires the file must exist."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," requires the file be successfully read from disk."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"Assertions",children:["Assertions ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Assertions",children:(0,s.jsx)(t,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," will automatically\n",(0,s.jsx)(n.a,{href:"/app/core-concepts/retry-ability",children:"retry"})," until all chained assertions have\npassed."]}),"\n"]}),"\n",(0,s.jsxs)(n.h3,{id:"Timeouts",children:["Timeouts ",(0,s.jsx)(n.a,{href:"/app/core-concepts/introduction-to-cypress#Timeouts",children:(0,s.jsx)(t,{name:"question-circle"})})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," can time out waiting for assertions you've added to pass."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," can time out when the content being read takes a significant\namount of time to encode."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"Command-Log",children:"Command Log"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.em,{children:"List the contents of your package.json file"})})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"cy.readFile('package.json')\n"})}),"\n",(0,s.jsx)(n.p,{children:"The command above will display in the Command Log as:"}),"\n",(0,s.jsx)(i,{src:"/img/api/readfile/readfile-can-get-content-of-system-files-in-tests.png",alt:"Command Log readFile"}),"\n",(0,s.jsxs)(n.p,{children:["When clicking on the ",(0,s.jsx)(n.code,{children:"readFile"})," command within the command log, the console\noutputs the following:"]}),"\n",(0,s.jsx)(i,{src:"/img/api/readfile/console-log-shows-content-from-file-formatted-as-javascript.png",alt:"Console Log readFile"}),"\n",(0,s.jsx)(n.h2,{id:"History",children:"History"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Version"}),(0,s.jsx)(n.th,{children:"Changes"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#13-0-0",children:"13.0.0"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," became a query"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#9-0-0",children:"9.0.0"})}),(0,s.jsxs)(n.td,{children:["Changed ",(0,s.jsx)(n.code,{children:"null"})," encoding to read as Buffer"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#0-17-2",children:"0.17.2"})}),(0,s.jsx)(n.td,{children:"Improved error messaging"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.a,{href:"/app/references/changelog#0-17-1",children:"0.17.1"})}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.code,{children:"cy.readFile()"})," command added"]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"See-also",children:"See also"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/api/commands/exec",children:(0,s.jsx)(n.code,{children:"cy.exec()"})})}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/api/commands/fixture",children:(0,s.jsx)(n.code,{children:"cy.fixture()"})})," for a similar command with caching\nthat does not retry"]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/api/commands/task",children:(0,s.jsx)(n.code,{children:"cy.task()"})})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/api/commands/writefile",children:(0,s.jsx)(n.code,{children:"cy.writeFile()"})})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}function x(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},1151:(e,n,i)=>{i.d(n,{Z:()=>r,a:()=>a});var s=i(7294);const l={},t=s.createContext(l);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);