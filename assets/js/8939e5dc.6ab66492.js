"use strict";(self.webpackChunkcypress_docusaurus_zh=self.webpackChunkcypress_docusaurus_zh||[]).push([[9906],{3259:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>t,toc:()=>l});var r=n(5893),i=n(1151);const d={title:"request"},c=void 0,t={id:"api/commands/request",title:"request",description:"Make an HTTP request.",source:"@site/docs/api/commands/request.mdx",sourceDirName:"api/commands",slug:"/api/commands/request",permalink:"/api/commands/request",draft:!1,unlisted:!1,editUrl:"https://github.com/cypress-io/cypress-documentation/tree/main/docs/api/commands/request.mdx",tags:[],version:"current",lastUpdatedAt:1732009455,formattedLastUpdatedAt:"Nov 19, 2024",frontMatter:{title:"request"},sidebar:"api",previous:{title:"reload",permalink:"/api/commands/reload"},next:{title:"rightclick",permalink:"/api/commands/rightclick"}},o={},l=[{value:"Syntax",id:"Syntax",level:2},{value:"Usage",id:"Usage",level:3},{value:"Arguments",id:"Arguments",level:3},{value:"Yields <Icon></Icon>",id:"Yields",level:3},{value:"Examples",id:"Examples",level:2},{value:"URL",id:"URL",level:3},{value:"Make a <code>GET</code> request",id:"Make-a-GET-request",level:4},{value:"Issue an HTTP request",id:"Issue-an-HTTP-request",level:4},{value:"Method and URL",id:"Method-and-URL",level:3},{value:"Send a <code>DELETE</code> request",id:"Send-a-DELETE-request",level:4},{value:"Alias the request using .as()",id:"Alias-the-request-using-as",level:4},{value:"Method, URL, and Body",id:"Method-URL-and-Body",level:3},{value:"Send a <code>POST</code> request with a JSON body",id:"Send-a-POST-request-with-a-JSON-body",level:4},{value:"Options",id:"Options",level:3},{value:"Request a page while disabling auto redirect",id:"Request-a-page-while-disabling-auto-redirect",level:4},{value:"Download a PDF file",id:"Download-a-PDF-file",level:4},{value:"Get Data URL of an image",id:"Get-Data-URL-of-an-image",level:4},{value:"HTML form submissions using form option",id:"HTML-form-submissions-using-form-option",level:4},{value:"Using <code>cy.request()</code> for HTML Forms",id:"Using-cyrequest-for-HTML-Forms",level:4},{value:"Request Polling",id:"Request-Polling",level:3},{value:"Call <code>cy.request()</code> over and over again",id:"Call-cyrequest-over-and-over-again",level:4},{value:"Notes",id:"Notes",level:2},{value:"Debugging",id:"Debugging",level:3},{value:"Request is not displayed in the Network Tab of Developer Tools",id:"Request-is-not-displayed-in-the-Network-Tab-of-Developer-Tools",level:4},{value:"CORS",id:"CORS",level:3},{value:"CORS is bypassed",id:"CORS-is-bypassed",level:4},{value:"Cookies",id:"Cookies",level:3},{value:"Cookies are automatically sent and received",id:"Cookies-are-automatically-sent-and-received",level:4},{value:"<code>cy.intercept()</code>",id:"cyintercept",level:3},{value:"<code>cy.request()</code> sends requests to actual endpoints, bypassing those defined using <code>cy.intercept()</code>",id:"cyrequest-sends-requests-to-actual-endpoints-bypassing-those-defined-using-cyintercept",level:4},{value:"User agent",id:"User-agent",level:3},{value:"Rules",id:"Rules",level:2},{value:"Requirements <Icon></Icon>",id:"Requirements",level:3},{value:"Assertions <Icon></Icon>",id:"Assertions",level:3},{value:"Timeouts <Icon></Icon>",id:"Timeouts",level:3},{value:"Command Log",id:"Command-Log",level:2},{value:"History",id:"History",level:2},{value:"See also",id:"See-also",level:2}];function a(e){const s={a:"a",admonition:"admonition",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.a)(),...e.components},{CypressConfigFileTabs:n,DocsImage:d,Icon:c}=s;return n||x("CypressConfigFileTabs",!0),d||x("DocsImage",!0),c||x("Icon",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.p,{children:"Make an HTTP request."}),"\n",(0,r.jsx)(s.h2,{id:"Syntax",children:"Syntax"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request(url)\ncy.request(url, body)\ncy.request(method, url)\ncy.request(method, url, body)\ncy.request(options)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"Usage",children:"Usage"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(c,{name:"check-circle",color:"green"})," ",(0,r.jsx)(s.strong,{children:"Correct Usage"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('http://dev.local/seed')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"Arguments",children:"Arguments"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(c,{name:"angle-right"})," ",(0,r.jsxs)(s.strong,{children:["url ",(0,r.jsx)(s.em,{children:"(String)"})]})]}),"\n",(0,r.jsx)(s.p,{children:"The URL to make the request to."}),"\n",(0,r.jsxs)(s.p,{children:["If you do not provide a fully qualified domain name (FQDN) URL, Cypress will\nmake its best guess as to which host you want ",(0,r.jsx)(s.code,{children:"cy.request()"})," to use in the URL."]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["If you make a ",(0,r.jsx)(s.code,{children:"cy.request()"})," after visiting a page, Cypress assumes the URL\nused for the ",(0,r.jsx)(s.code,{children:"cy.visit()"})," is the host."]}),"\n"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.visit('http://localhost:8080/app')\ncy.request('users/1.json') //  URL is  http://localhost:8080/users/1.json\n"})}),"\n",(0,r.jsxs)(s.ol,{start:"2",children:["\n",(0,r.jsxs)(s.li,{children:["If you make a ",(0,r.jsx)(s.code,{children:"cy.request()"})," prior to visiting a page, Cypress assumes the\nhost is the ",(0,r.jsx)(s.code,{children:"baseUrl"})," property configured inside of of your\n",(0,r.jsx)(s.a,{href:"/app/references/configuration",children:"configuration file"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(n,{children:[(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",metastring:"",children:"const { defineConfig } = require('cypress')\n\nmodule.exports = defineConfig({\n  e2e: {\n    baseUrl: 'http://localhost:1234',\n  },\n})\n"})}),(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-typescript",metastring:"",children:"import { defineConfig } from 'cypress'\n\nexport default defineConfig({\n  e2e: {\n    baseUrl: 'http://localhost:1234',\n  },\n})\n"})})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('seed/admin') // URL is http://localhost:1234/seed/admin\n"})}),"\n",(0,r.jsxs)(s.ol,{start:"3",children:["\n",(0,r.jsx)(s.li,{children:"If Cypress cannot determine the host it will throw an error."}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(c,{name:"angle-right"})," ",(0,r.jsxs)(s.strong,{children:["body ",(0,r.jsx)(s.em,{children:"(String, Object)"})]})]}),"\n",(0,r.jsxs)(s.p,{children:["A request ",(0,r.jsx)(s.code,{children:"body"})," to be sent in the request. Cypress sets the ",(0,r.jsx)(s.code,{children:"Accepts"})," request\nheader and serializes the response body by the ",(0,r.jsx)(s.code,{children:"encoding"})," option."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(c,{name:"angle-right"})," ",(0,r.jsxs)(s.strong,{children:["method ",(0,r.jsx)(s.em,{children:"(String)"})]})]}),"\n",(0,r.jsxs)(s.p,{children:["Make a request using a specific method. If no method is defined, Cypress uses\nthe ",(0,r.jsx)(s.code,{children:"GET"})," method by default."]}),"\n",(0,r.jsx)(s.p,{children:"Supported methods include:"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"GET"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"POST"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"PUT"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"DELETE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"PATCH"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"HEAD"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"OPTIONS"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"TRACE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"COPY"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"LOCK"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"MKCOL"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"MOVE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"PURGE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"PROPFIND"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"PROPPATCH"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"UNLOCK"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"REPORT"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"MKACTIVITY"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"CHECKOUT"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"MERGE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"M-SEARCH"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"NOTIFY"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"SUBSCRIBE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"UNSUBSCRIBE"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"SEARCH"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"CONNECT"})}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(c,{name:"angle-right"})," ",(0,r.jsxs)(s.strong,{children:["options ",(0,r.jsx)(s.em,{children:"(Object)"})]})]}),"\n",(0,r.jsxs)(s.p,{children:["Pass in an options object to change the default behavior of ",(0,r.jsx)(s.code,{children:"cy.request()"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:["You can also set options for ",(0,r.jsx)(s.code,{children:"cy.request()"}),"'s ",(0,r.jsx)(s.code,{children:"baseUrl"})," and ",(0,r.jsx)(s.code,{children:"responseTimeout"}),"\nglobally in ",(0,r.jsx)(s.a,{href:"/app/references/configuration",children:"configuration"}),"."]}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Option"}),(0,r.jsx)(s.th,{children:"Default"}),(0,r.jsx)(s.th,{children:"Description"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"log"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"true"})}),(0,r.jsxs)(s.td,{children:["Displays the command in the ",(0,r.jsx)(s.a,{href:"/app/core-concepts/open-mode#Command-Log",children:"Command log"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"url"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"null"})}),(0,r.jsx)(s.td,{children:"The URL to make the request to"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"method"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"GET"})}),(0,r.jsx)(s.td,{children:"The HTTP method to use in the request"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"auth"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"null"})}),(0,r.jsxs)(s.td,{children:["Adds Authorization headers. ",(0,r.jsx)(s.a,{href:"https://github.com/request/request#http-authentication",children:"Accepts these options."})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"body"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"null"})}),(0,r.jsx)(s.td,{children:"Body to send along with the request"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"failOnStatusCode"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"true"})}),(0,r.jsxs)(s.td,{children:["Whether to fail on response codes other than ",(0,r.jsx)(s.code,{children:"2xx"})," and ",(0,r.jsx)(s.code,{children:"3xx"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"followRedirect"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"true"})}),(0,r.jsx)(s.td,{children:"Whether to automatically follow redirects"})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"form"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"false"})}),(0,r.jsxs)(s.td,{children:["Whether to convert the ",(0,r.jsx)(s.code,{children:"body"})," values to URL encoded content and set the ",(0,r.jsx)(s.code,{children:"x-www-form-urlencoded"})," header"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"encoding"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"utf8"})}),(0,r.jsxs)(s.td,{children:["The encoding to be used when serializing the response body. The following encodings are supported: ",(0,r.jsx)(s.code,{children:"ascii"}),", ",(0,r.jsx)(s.code,{children:"base64"}),", ",(0,r.jsx)(s.code,{children:"binary"}),", ",(0,r.jsx)(s.code,{children:"hex"}),", ",(0,r.jsx)(s.code,{children:"latin1"}),", ",(0,r.jsx)(s.code,{children:"utf8"}),", ",(0,r.jsx)(s.code,{children:"utf-8"}),", ",(0,r.jsx)(s.code,{children:"ucs2"}),", ",(0,r.jsx)(s.code,{children:"ucs-2"}),", ",(0,r.jsx)(s.code,{children:"utf16le"}),", ",(0,r.jsx)(s.code,{children:"utf-16le"})]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"gzip"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"true"})}),(0,r.jsxs)(s.td,{children:["Whether to accept the ",(0,r.jsx)(s.code,{children:"gzip"})," encoding"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"headers"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"null"})}),(0,r.jsxs)(s.td,{children:["Additional headers to send; Accepts object literal. ",(0,r.jsx)(s.em,{children:"Note:"})," ",(0,r.jsx)(s.code,{children:"headers"})," will only be sent for the initial request for ",(0,r.jsx)(s.code,{children:"cy.request()"}),", not for any subsequent requests."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"qs"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"null"})}),(0,r.jsxs)(s.td,{children:["Query parameters to append to the ",(0,r.jsx)(s.code,{children:"url"})," of the request"]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"retryOnStatusCodeFailure"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"false"})}),(0,r.jsx)(s.td,{children:"Whether Cypress should automatically retry status code errors under the hood. Cypress will retry a request up to 4 times if this is set to true."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"retryOnNetworkFailure"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"true"})}),(0,r.jsx)(s.td,{children:"Whether Cypress should automatically retry transient network errors under the hood. Cypress will retry a request up to 4 times if this is set to true."})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.code,{children:"timeout"})}),(0,r.jsx)(s.td,{children:(0,r.jsx)(s.a,{href:"/app/references/configuration#Timeouts",children:(0,r.jsx)(s.code,{children:"responseTimeout"})})}),(0,r.jsxs)(s.td,{children:["Time to wait for ",(0,r.jsx)(s.code,{children:"cy.request()"})," to resolve before ",(0,r.jsx)(s.a,{href:"#Timeouts",children:"timing out"})]})]})]})]}),"\n",(0,r.jsxs)(s.p,{children:["You can also set options for ",(0,r.jsx)(s.code,{children:"cy.request()"}),"'s ",(0,r.jsx)(s.code,{children:"baseUrl"})," and ",(0,r.jsx)(s.code,{children:"responseTimeout"}),"\nglobally in the ",(0,r.jsx)(s.a,{href:"/app/references/configuration",children:"Cypress configuration"}),"."]}),"\n",(0,r.jsxs)(s.h3,{id:"Yields",children:["Yields ",(0,r.jsx)(s.a,{href:"/app/core-concepts/introduction-to-cypress#Subject-Management",children:(0,r.jsx)(c,{name:"question-circle"})})]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," yields the ",(0,r.jsx)(s.code,{children:"response"})," as an object literal containing properties\nsuch as:"]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"status"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"body"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"headers"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.code,{children:"duration"})}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"Examples",children:"Examples"}),"\n",(0,r.jsx)(s.h3,{id:"URL",children:"URL"}),"\n",(0,r.jsxs)(s.h4,{id:"Make-a-GET-request",children:["Make a ",(0,r.jsx)(s.code,{children:"GET"})," request"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," is great for talking to an external endpoint before your tests to\nseed a database."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"beforeEach(() => {\n  cy.request('http://localhost:8080/db/seed')\n})\n"})}),"\n",(0,r.jsx)(s.h4,{id:"Issue-an-HTTP-request",children:"Issue an HTTP request"}),"\n",(0,r.jsxs)(s.p,{children:["Sometimes it's quicker to test the contents of a page rather than\n",(0,r.jsx)(s.a,{href:"/api/commands/visit",children:(0,r.jsx)(s.code,{children:"cy.visit()"})})," and wait for the entire page and all of its\nresources to load."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('/admin').its('body').should('include', '<h1>Admin</h1>')\n"})}),"\n",(0,r.jsx)(s.h3,{id:"Method-and-URL",children:"Method and URL"}),"\n",(0,r.jsxs)(s.h4,{id:"Send-a-DELETE-request",children:["Send a ",(0,r.jsx)(s.code,{children:"DELETE"})," request"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('DELETE', 'http://localhost:8888/users/827')\n"})}),"\n",(0,r.jsxs)(s.h4,{id:"Alias-the-request-using-as",children:["Alias the request using ",(0,r.jsx)(s.a,{href:"/api/commands/as",children:".as()"})]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('https://jsonplaceholder.cypress.io/comments').as('comments')\n\ncy.get('@comments').should((response) => {\n  expect(response.body).to.have.length(500)\n  expect(response).to.have.property('headers')\n  expect(response).to.have.property('duration')\n})\n"})}),"\n",(0,r.jsx)(s.h3,{id:"Method-URL-and-Body",children:"Method, URL, and Body"}),"\n",(0,r.jsxs)(s.h4,{id:"Send-a-POST-request-with-a-JSON-body",children:["Send a ",(0,r.jsx)(s.code,{children:"POST"})," request with a JSON body"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('POST', 'http://localhost:8888/users/admin', { name: 'Jane' }).then(\n  (response) => {\n    // response.body is automatically serialized into JSON\n    expect(response.body).to.have.property('name', 'Jane') // true\n  }\n)\n"})}),"\n",(0,r.jsx)(s.h3,{id:"Options",children:"Options"}),"\n",(0,r.jsx)(s.h4,{id:"Request-a-page-while-disabling-auto-redirect",children:"Request a page while disabling auto redirect"}),"\n",(0,r.jsxs)(s.p,{children:["To test the redirection behavior of a login without a session, ",(0,r.jsx)(s.code,{children:"cy.request"})," can\nbe used to check the ",(0,r.jsx)(s.code,{children:"status"})," and ",(0,r.jsx)(s.code,{children:"redirectedToUrl"})," property."]}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"redirectedToUrl"})," property is a special Cypress property that normalizes the\nURL the browser would normally follow during a redirect."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request({\n  url: '/dashboard',\n  followRedirect: false, // turn off following redirects\n}).then((resp) => {\n  // redirect status code is 302\n  expect(resp.status).to.eq(302)\n  expect(resp.redirectedToUrl).to.eq('http://localhost:8082/unauthorized')\n})\n"})}),"\n",(0,r.jsx)(s.h4,{id:"Download-a-PDF-file",children:"Download a PDF file"}),"\n",(0,r.jsxs)(s.p,{children:["By passing the ",(0,r.jsx)(s.code,{children:"encoding: binary"})," option, the ",(0,r.jsx)(s.code,{children:"response.body"})," will be serialized\nbinary content of the file. You can use this to access various file types via\n",(0,r.jsx)(s.code,{children:".request()"})," like ",(0,r.jsx)(s.code,{children:".pdf"}),", ",(0,r.jsx)(s.code,{children:".zip"}),", or ",(0,r.jsx)(s.code,{children:".doc"})," files."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request({\n  url: 'http://localhost:8080/some-document.pdf',\n  encoding: 'binary',\n}).then((response) => {\n  cy.writeFile('path/to/save/document.pdf', response.body, 'binary')\n})\n"})}),"\n",(0,r.jsx)(s.h4,{id:"Get-Data-URL-of-an-image",children:"Get Data URL of an image"}),"\n",(0,r.jsxs)(s.p,{children:["By passing the ",(0,r.jsx)(s.code,{children:"encoding: base64"})," option, the ",(0,r.jsx)(s.code,{children:"response.body"})," will be\nbase64-encoded content of the image. You can use this to construct a\n",(0,r.jsx)(s.a,{href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs",children:"Data URI"}),"\nfor use elsewhere."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request({\n  url: 'https://docs.cypress.io/img/logo.png',\n  encoding: 'base64',\n}).then((response) => {\n  const base64Content = response.body\n  const mime = response.headers['content-type'] // or 'image/png'\n  // see https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs\n  const imageDataUrl = `data:${mime};base64,${base64Content}`\n})\n"})}),"\n",(0,r.jsx)(s.h4,{id:"HTML-form-submissions-using-form-option",children:"HTML form submissions using form option"}),"\n",(0,r.jsxs)(s.p,{children:["Oftentimes, once you have a proper e2e test around logging in, there's no reason\nto continue to ",(0,r.jsx)(s.code,{children:"cy.visit()"})," the login and wait for the entire page to load all\nassociated resources before running any other commands. Doing so can slow down\nour entire test suite."]}),"\n",(0,r.jsxs)(s.p,{children:["Using ",(0,r.jsx)(s.code,{children:"cy.request()"}),", we can bypass all of this because it automatically gets\nand sets cookies as if the requests had come from the browser."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request({\n  method: 'POST',\n  url: '/login_with_form', // baseUrl is prepend to URL\n  form: true, // indicates the body should be form urlencoded and sets Content-Type: application/x-www-form-urlencoded headers\n  body: {\n    username: 'jane.lane',\n    password: 'password123',\n  },\n})\n\n// to prove we have a session\ncy.getCookie('cypress-session-cookie').should('exist')\n"})}),"\n",(0,r.jsxs)(s.h4,{id:"Using-cyrequest-for-HTML-Forms",children:["Using ",(0,r.jsx)(s.code,{children:"cy.request()"})," for HTML Forms"]}),"\n",(0,r.jsx)(s.admonition,{type:"info",children:(0,r.jsx)(s.p,{children:(0,r.jsxs)(s.a,{href:"/app/references/recipes#Logging-In",children:["Check out our example recipe using ",(0,r.jsx)(s.code,{children:"cy.request()"})," for HTML web forms"]})})}),"\n",(0,r.jsx)(s.h3,{id:"Request-Polling",children:"Request Polling"}),"\n",(0,r.jsxs)(s.h4,{id:"Call-cyrequest-over-and-over-again",children:["Call ",(0,r.jsx)(s.code,{children:"cy.request()"})," over and over again"]}),"\n",(0,r.jsx)(s.p,{children:"This is useful when you're polling a server for a response that may take awhile\nto complete."}),"\n",(0,r.jsx)(s.p,{children:"All we're really doing here is creating a recursive function. Nothing more\ncomplicated than that."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-js",children:"// a regular ol' function folks\nfunction req () {\n  cy\n    .request(...)\n    .then((resp) => {\n      // if we got what we wanted\n\n      if (resp.status === 200 && resp.body.ok === true)\n        // break out of the recursive loop\n        return\n\n      // else recurse\n      req()\n    })\n}\n\ncy\n  // do the thing causing the side effect\n  .get('button').click()\n\n  // now start the requests\n  .then(req)\n\n"})}),"\n",(0,r.jsx)(s.h2,{id:"Notes",children:"Notes"}),"\n",(0,r.jsx)(s.h3,{id:"Debugging",children:"Debugging"}),"\n",(0,r.jsx)(s.h4,{id:"Request-is-not-displayed-in-the-Network-Tab-of-Developer-Tools",children:"Request is not displayed in the Network Tab of Developer Tools"}),"\n",(0,r.jsxs)(s.p,{children:["Cypress does not ",(0,r.jsx)(s.em,{children:"actually"})," make an XHR request from the browser. We are\nactually making the HTTP request from Cypress (in Node). So, you won't see the\nrequest inside of your Developer Tools."]}),"\n",(0,r.jsx)(s.h3,{id:"CORS",children:"CORS"}),"\n",(0,r.jsx)(s.h4,{id:"CORS-is-bypassed",children:"CORS is bypassed"}),"\n",(0,r.jsxs)(s.p,{children:["Normally when the browser detects a cross-origin HTTP request, it will send an\n",(0,r.jsx)(s.code,{children:"OPTIONS"})," preflight check to ensure the server allows cross-origin requests, but\n",(0,r.jsx)(s.code,{children:"cy.request()"})," bypasses CORS entirely."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"// we can make requests to any external server, no problem.\ncy.request('https://www.google.com/webhp?#q=cypress.io+cors')\n  .its('body')\n  .should('include', 'Testing, the way it should be') // true\n"})}),"\n",(0,r.jsx)(s.h3,{id:"Cookies",children:"Cookies"}),"\n",(0,r.jsx)(s.h4,{id:"Cookies-are-automatically-sent-and-received",children:"Cookies are automatically sent and received"}),"\n",(0,r.jsxs)(s.p,{children:["Before sending the HTTP request, we automatically attach cookies that would have\notherwise been attached had the request come from the browser. Additionally, if\na response has a ",(0,r.jsx)(s.code,{children:"Set-Cookie"})," header, these are automatically set back on the\nbrowser cookies."]}),"\n",(0,r.jsxs)(s.p,{children:["In other words, ",(0,r.jsx)(s.code,{children:"cy.request()"})," transparently performs all of the underlying\nfunctions as if it came from the browser."]}),"\n",(0,r.jsx)(s.h3,{id:"cyintercept",children:(0,r.jsx)(s.a,{href:"/api/commands/intercept",children:(0,r.jsx)(s.code,{children:"cy.intercept()"})})}),"\n",(0,r.jsxs)(s.h4,{id:"cyrequest-sends-requests-to-actual-endpoints-bypassing-those-defined-using-cyintercept",children:[(0,r.jsx)(s.code,{children:"cy.request()"})," sends requests to actual endpoints, bypassing those defined using ",(0,r.jsx)(s.code,{children:"cy.intercept()"})]}),"\n",(0,r.jsxs)(s.p,{children:["The intention of ",(0,r.jsx)(s.code,{children:"cy.request()"})," is to be used for checking endpoints on an\nactual, running server without having to start the front end application."]}),"\n",(0,r.jsx)(s.h3,{id:"User-agent",children:"User agent"}),"\n",(0,r.jsxs)(s.p,{children:["Trying to change the ",(0,r.jsx)(s.code,{children:"User-Agent"}),"?"]}),"\n",(0,r.jsxs)(s.p,{children:["See\n",(0,r.jsx)(s.a,{href:"/app/faq#Can-I-override-or-change-the-default-user-agent-the-browser-uses",children:"how to override the browser's default user agent"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"Rules",children:"Rules"}),"\n",(0,r.jsxs)(s.h3,{id:"Requirements",children:["Requirements ",(0,r.jsx)(s.a,{href:"/app/core-concepts/introduction-to-cypress#Chains-of-Commands",children:(0,r.jsx)(c,{name:"question-circle"})})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," requires being chained off of ",(0,r.jsx)(s.code,{children:"cy"}),"."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," requires that the server sends a response."]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," requires that the response status code be ",(0,r.jsx)(s.code,{children:"2xx"})," or ",(0,r.jsx)(s.code,{children:"3xx"})," when\n",(0,r.jsx)(s.code,{children:"failOnStatusCode"})," is ",(0,r.jsx)(s.code,{children:"true"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"Assertions",children:["Assertions ",(0,r.jsx)(s.a,{href:"/app/core-concepts/introduction-to-cypress#Assertions",children:(0,r.jsx)(c,{name:"question-circle"})})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," will only run assertions you have chained once, and will not\n",(0,r.jsx)(s.a,{href:"/app/core-concepts/retry-ability",children:"retry"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.h3,{id:"Timeouts",children:["Timeouts ",(0,r.jsx)(s.a,{href:"/app/core-concepts/introduction-to-cypress#Timeouts",children:(0,r.jsx)(c,{name:"question-circle"})})]}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"cy.request()"})," can time out waiting for the server to respond."]}),"\n"]}),"\n",(0,r.jsx)(s.h2,{id:"Command-Log",children:"Command Log"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:(0,r.jsx)(s.em,{children:"Request comments endpoint and test response"})})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-javascript",children:"cy.request('https://jsonplaceholder.typicode.com/comments').then((response) => {\n  expect(response.status).to.eq(200)\n  expect(response.body).to.have.length(500)\n  expect(response).to.have.property('headers')\n  expect(response).to.have.property('duration')\n})\n"})}),"\n",(0,r.jsx)(s.p,{children:"The commands above will display in the Command Log as:"}),"\n",(0,r.jsx)(d,{src:"/img/api/request/testing-request-url-and-its-response-body-headers.png",alt:"Command Log request"}),"\n",(0,r.jsxs)(s.p,{children:["When clicking on ",(0,r.jsx)(s.code,{children:"request"})," within the command log, the console outputs the\nfollowing:"]}),"\n",(0,r.jsx)(d,{src:"/img/api/request/console-log-request-response-body-headers-status-url.png",alt:"Console Log request"}),"\n",(0,r.jsx)(s.h2,{id:"History",children:"History"}),"\n",(0,r.jsxs)(s.table,{children:[(0,r.jsx)(s.thead,{children:(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.th,{children:"Version"}),(0,r.jsx)(s.th,{children:"Changes"})]})}),(0,r.jsxs)(s.tbody,{children:[(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.a,{href:"/app/references/changelog#3-3-0",children:"4.7.0"})}),(0,r.jsxs)(s.td,{children:["Added support for ",(0,r.jsx)(s.code,{children:"encoding"})," option."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.a,{href:"/app/references/changelog#3-3-0",children:"3.3.0"})}),(0,r.jsxs)(s.td,{children:["Added support for options ",(0,r.jsx)(s.code,{children:"retryOnStatusCodeFailure"})," and ",(0,r.jsx)(s.code,{children:"retryOnNetworkFailure"}),"."]})]}),(0,r.jsxs)(s.tr,{children:[(0,r.jsx)(s.td,{children:(0,r.jsx)(s.a,{href:"/app/references/changelog#3-2-0",children:"3.2.0"})}),(0,r.jsxs)(s.td,{children:["Added support for any valid HTTP ",(0,r.jsx)(s.code,{children:"method"})," argument including ",(0,r.jsx)(s.code,{children:"TRACE"}),", ",(0,r.jsx)(s.code,{children:"COPY"}),", ",(0,r.jsx)(s.code,{children:"LOCK"}),", ",(0,r.jsx)(s.code,{children:"MKCOL"}),", ",(0,r.jsx)(s.code,{children:"MOVE"}),", ",(0,r.jsx)(s.code,{children:"PURGE"}),", ",(0,r.jsx)(s.code,{children:"PROPFIND"}),", ",(0,r.jsx)(s.code,{children:"PROPPATCH"}),", ",(0,r.jsx)(s.code,{children:"UNLOCK"}),", ",(0,r.jsx)(s.code,{children:"REPORT"}),", ",(0,r.jsx)(s.code,{children:"MKACTIVITY"}),", ",(0,r.jsx)(s.code,{children:"CHECKOUT"}),", ",(0,r.jsx)(s.code,{children:"MERGE"}),", ",(0,r.jsx)(s.code,{children:"M-SEARCH"}),", ",(0,r.jsx)(s.code,{children:"NOTIFY"}),", ",(0,r.jsx)(s.code,{children:"SUBSCRIBE"}),", ",(0,r.jsx)(s.code,{children:"UNSUBSCRIBE"}),", ",(0,r.jsx)(s.code,{children:"SEARCH"}),", and ",(0,r.jsx)(s.code,{children:"CONNECT"}),"."]})]})]})]}),"\n",(0,r.jsx)(s.h2,{id:"See-also",children:"See also"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/api/commands/exec",children:(0,r.jsx)(s.code,{children:"cy.exec()"})})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/api/commands/task",children:(0,r.jsx)(s.code,{children:"cy.task()"})})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/api/commands/visit",children:(0,r.jsx)(s.code,{children:"cy.visit()"})})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/app/references/recipes#Logging-In",children:"Recipe: Logging In - Single Sign on"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/app/references/recipes#Logging-In",children:"Recipe: Logging In - HTML Web Form"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/app/references/recipes#Logging-In",children:"Recipe: Logging In - XHR Web Form"})}),"\n",(0,r.jsx)(s.li,{children:(0,r.jsx)(s.a,{href:"/app/references/recipes#Logging-In",children:"Recipe: Logging In - CSRF Tokens"})}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}function x(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},1151:(e,s,n)=>{n.d(s,{Z:()=>t,a:()=>c});var r=n(7294);const i={},d=r.createContext(i);function c(e){const s=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function t(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(d.Provider,{value:s},e.children)}}}]);